#!/bin/bash

make clean
make

declare -a time
#time=( 0817 0819 0819 0823 0949 0952 0952 0954 0954 0956 0956 0960 0960 0965 0965 0969 0995 1000 1000 1002 1002 1004 1011 1013 ) # 60000 cutoff 2-6 days 2006

time=( 1000 1000 1002 1002 1004 1011 1013 ) # 60000 cutoff 2-6 days 2006

#time="398 451 467 481 485 537 581 616"

#time=( 051 056 056 057 057 058 058 060 060 064 064 067 074 080 080 083 099 101 120 122 122 126 126 128 128 129 151 152 152 156 163 168 168 172 220 222 236 238 245 247 247 249 256 258 258 259 259 264 264 268 268 270 279 280 280 282 328 332 332 334 398 402 402 403 424 430 439 442 442 444 444 446 446 451 451 455 455 456 465 466 466 467 467 469 469 471 471 472 472 474 474 478 478 481 481 482 482 485 485 488 488 489 489 490 537 540 540 542 558 563 563 568 568 569 569 570 570 576 576 578 578 581 581 585 585 586 597 601 601 604 604 606 606 611 611 613 613 615 615 616 616 617 617 620 631 633 633 634 634 636 636 640 640 641 641 642 689 691 )

#time=( 074 080 080 083 099 101 122 126 126 128 152 156 168 172 236 238 245 247 264 268 268 270 )
#time=( 280 282 328 332 398 403 424 430 442 444 451 456 465 467 467 469 469 471 472 474 481 485 )
#time=(485 488 488 490 537 540 581 586 604 606 606 611 611 613 613 615 617 620 634 640 689 691 )

time=( 0033 0035 0035 0041 0042 0046 0046 0048 0048 0051 0051 0055 0058 0060 0060 0064 0064 0067 0083 0088 0108 0112 0129 0131 0131 0133 0163 0165 0165 0168 0169 0172 0220 0222 0222 0225 0225 0227 0227 0231 0231 0236 0238 0240 0241 0245 0247 0249 0249 0254 0254 0256 0256 0258 0259 0264 0266 0268 0270 0274 0275 0279 0302 0304 0304 0309 0309 0312 0312 0314 0325 0328 0332 0334 0334 0337 0357 0360 0394 0396 0396 0398 0411 0414 0414 0417 0417 0423 0439 0442 0444 0446 0446 0451 0456 0462 0462 0465 0475 0478 0478 0481 0482 0485 0490 0496 0496 0499 0540 0542 0558 0563 0563 0568 0570 0576 0576 0578 0578 0581 0586 0590 0590 0595 0595 0597 0597 0600 0602 0604 0631 0633 0636 0640 0659 0661 0661 0666 0666 0670 0670 0672 0672 0677 0677 0682 0682 0684 0684 0686 0686 0689 0741 0743 0744 0748 0748 0753 0753 0755 0773 0775 0796 0798 0798 0801 0801 0807 0808 0810 0810 0814 0814 0817 0821 0823 0824 0826 0826 0832 0833 0835 0835 0841 0843 0846 0846 0848 0849 0851 0872 0874 0874 0876 0876 0881 0894 0898 0899 0903 0913 0915 0915 0919 0937 0942 0942 0945 0945 0949 0967 0969 0969 0974 0974 0977 1013 1018 1018 1020 1020 1025 1034 1036 1036 1038 1038 1040 1040 1045 )



timelength=${#time[@]}
date > log
for ((i=0;i<$timelength;i=i+2)); 
  do
  jd1=${time[${i}]}
  jd2=${time[${i}+1]}
  table="f"$jd1"B"

  CT1="CREATE TABLE IF NOT EXISTS traj."$table"run  "
  CT2="(ints INT,ntrac INT,n REAL,x1 REAL,y1 REAL,z1 REAL,tt " 
  CT3=" REAL,t0 REAL,subvol REAL,temp REAL,salt REAL,dens "
  CT4=" REAL,arct REAL, ijk REAL, INDEX(ints), INDEX(ntrac), INDEX(ijk) );"
  CT="$CT1 $CT2 $CT3 $CT4"
  TR="TRUNCATE traj."$table"run;" 
  
  /usr/local/mysql/bin/mysql -D traj -u root -e "$CT"
  /usr/local/mysql/bin/mysql -D traj -u root -e "$TR"

  ./runtraj $jd1 $jd2 $table".01"
  echo $jd1 >> log
  date >> log
done
